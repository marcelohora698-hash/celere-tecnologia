<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Célere - Tecnologia em Saúde</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* SEU CSS EXISTENTE AQUI (mantenha todo o CSS que você já tem) */
        /* Adicione apenas este CSS adicional: */
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .equipamento-check:checked + label {
            color: #20c997 !important;
            font-weight: bold;
        }
        
        .quantidade-input {
            max-width: 120px;
            text-align: center;
        }
        
        .badge {
            min-width: 30px;
        }
    </style>
</head>
<body>
    <!-- SEU HTML EXISTENTE AQUI (mantenha todo o HTML que você já tem) -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ========== SISTEMA DE ARMAZENAMENTO ==========
        let entregas = JSON.parse(localStorage.getItem('celere_entregas')) || [];
        let quantidades = {
            cpu: 0,
            monitor: 0,
            caboEnergiaDesktop: 0,
            caboEnergiaMonitor: 0,
            teclado: 0,
            mouse: 0,
            caboHdmi: 0,
            caboVga: 0
        };

        // ========== INICIALIZAÇÃO DO SISTEMA ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema Célere inicializado!');
            inicializarSistema();
        });

        function inicializarSistema() {
            // Configurar event listeners para todos os campos de quantidade
            const quantidadeInputs = document.querySelectorAll('.quantidade-input');
            quantidadeInputs.forEach(input => {
                input.addEventListener('input', function() {
                    atualizarProgresso();
                    atualizarTermo();
                    atualizarCheckboxes();
                });
            });

            // Configurar event listeners para dados do usuário
            ['tecnico', 'usuario', 'matricula', 'setor'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', atualizarTermo);
                }
            });

            // Configurar checkbox de aceite
            const aceiteTermo = document.getElementById('aceite-termo');
            if (aceiteTermo) {
                aceiteTermo.addEventListener('change', atualizarTermo);
            }

            // Configurar checkboxes de equipamentos
            const checkboxes = document.querySelectorAll('.equipamento-check, .periferico-check, .cabo-check');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const id = this.id;
                    const quantidadeInput = document.getElementById(`qtd-${id}`);
                    if (quantidadeInput) {
                        if (this.checked && parseInt(quantidadeInput.value) === 0) {
                            quantidadeInput.value = '1';
                        } else if (!this.checked) {
                            quantidadeInput.value = '0';
                        }
                        atualizarProgresso();
                        atualizarTermo();
                    }
                });
            });

            // Configurar checkbox do kit completo
            const kitCompleto = document.getElementById('kit-completo');
            if (kitCompleto) {
                kitCompleto.addEventListener('change', function() {
                    if (this.checked) {
                        // Preencher automaticamente os equipamentos básicos
                        document.getElementById('cpu').checked = true;
                        document.getElementById('monitor').checked = true;
                        document.getElementById('cabo-energia-desktop').checked = true;
                        document.getElementById('cabo-energia-monitor').checked = true;
                        document.getElementById('teclado').checked = true;
                        document.getElementById('mouse').checked = true;
                        
                        // Definir quantidades padrão
                        document.getElementById('qtd-cpu').value = '1';
                        document.getElementById('qtd-monitor').value = '1';
                        document.getElementById('qtd-cabo-energia-desktop').value = '1';
                        document.getElementById('qtd-cabo-energia-monitor').value = '1';
                        document.getElementById('qtd-teclado').value = '1';
                        document.getElementById('qtd-mouse').value = '1';
                        
                        atualizarProgresso();
                        atualizarTermo();
                        atualizarCheckboxes();
                    }
                });
            }

            // Inicializar valores
            atualizarProgresso();
            atualizarTermo();
            atualizarRelatorios();
            atualizarCheckboxes();
        }

        // ========== ATUALIZAR CHECKBOXES ==========
        function atualizarCheckboxes() {
            const equipamentos = [
                'cpu', 'monitor', 'cabo-energia-desktop', 'cabo-energia-monitor',
                'teclado', 'mouse', 'cabo-hdmi', 'cabo-vga'
            ];
            
            equipamentos.forEach(equip => {
                const checkbox = document.getElementById(equip);
                const quantidadeInput = document.getElementById(`qtd-${equip}`);
                
                if (checkbox && quantidadeInput) {
                    const qtd = parseInt(quantidadeInput.value) || 0;
                    checkbox.checked = qtd > 0;
                }
            });
        }

        // ========== SISTEMA DE STATUS ==========
        function mostrarStatus(mensagem, tipo) {
            const status = document.getElementById('syncStatus');
            if (!status) return;
            
            status.textContent = mensagem;
            status.className = `sync-status sync-${tipo}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // ========== ATUALIZAR PROGRESSO ==========
        function atualizarProgresso() {
            // Atualizar quantidades
            quantidades.cpu = parseInt(document.getElementById('qtd-cpu').value) || 0;
            quantidades.monitor = parseInt(document.getElementById('qtd-monitor').value) || 0;
            quantidades.caboEnergiaDesktop = parseInt(document.getElementById('qtd-cabo-energia-desktop').value) || 0;
            quantidades.caboEnergiaMonitor = parseInt(document.getElementById('qtd-cabo-energia-monitor').value) || 0;
            quantidades.teclado = parseInt(document.getElementById('qtd-teclado').value) || 0;
            quantidades.mouse = parseInt(document.getElementById('qtd-mouse').value) || 0;
            quantidades.caboHdmi = parseInt(document.getElementById('qtd-cabo-hdmi').value) || 0;
            quantidades.caboVga = parseInt(document.getElementById('qtd-cabo-vga').value) || 0;

            // Atualizar resumos
            document.getElementById('resumo-cpu').textContent = quantidades.cpu;
            document.getElementById('resumo-monitor').textContent = quantidades.monitor;
            document.getElementById('resumo-cabo-energia-desktop').textContent = quantidades.caboEnergiaDesktop;
            document.getElementById('resumo-cabo-energia-monitor').textContent = quantidades.caboEnergiaMonitor;
            document.getElementById('resumo-teclado').textContent = quantidades.teclado;
            document.getElementById('resumo-mouse').textContent = quantidades.mouse;
            document.getElementById('resumo-cabo-hdmi').textContent = quantidades.caboHdmi;
            document.getElementById('resumo-cabo-vga').textContent = quantidades.caboVga;

            // Atualizar badges
            document.getElementById('badge-cpu').textContent = quantidades.cpu;
            document.getElementById('badge-monitor').textContent = quantidades.monitor;
            document.getElementById('badge-cabo-energia-desktop').textContent = quantidades.caboEnergiaDesktop;
            document.getElementById('badge-cabo-energia-monitor').textContent = quantidades.caboEnergiaMonitor;
            document.getElementById('badge-teclado').textContent = quantidades.teclado;
            document.getElementById('badge-mouse').textContent = quantidades.mouse;
            document.getElementById('badge-cabo-hdmi').textContent = quantidades.caboHdmi;
            document.getElementById('badge-cabo-vga').textContent = quantidades.caboVga;

            // Calcular totais
            const totalEquipamentos = Object.values(quantidades).reduce((a, b) => a + b, 0);
            const percentual = Math.min(100, Math.round((totalEquipamentos / 440) * 100));

            // Atualizar progresso
            const progressoTexto = document.getElementById('progresso-texto');
            const progressoBar = document.getElementById('progresso-bar');
            
            if (progressoTexto) {
                progressoTexto.textContent = `Progresso: ${totalEquipamentos}/440 equipamentos (${percentual}%)`;
            }
            
            if (progressoBar) {
                progressoBar.style.width = `${percentual}%`;
                
                // Verificar se atingiu 100%
                if (percentual === 100) {
                    progressoBar.classList.add('bg-warning');
                } else {
                    progressoBar.classList.remove('bg-warning');
                }
            }
        }

        // ========== SISTEMA PRINCIPAL ==========
        function proximaAba(aba) {
            const tabElement = document.querySelector(`a[href="#${aba}"]`);
            if (tabElement) {
                const tab = new bootstrap.Tab(tabElement);
                tab.show();
            }
        }

        // ========== GERAR TERMO ==========
        function atualizarTermo() {
            // Atualizar informações do termo
            document.getElementById('termo-usuario').textContent = document.getElementById('usuario').value || '-';
            document.getElementById('termo-matricula').textContent = document.getElementById('matricula').value || '-';
            document.getElementById('termo-setor').textContent = document.getElementById('setor').value || '-';
            document.getElementById('termo-tecnico').textContent = document.getElementById('tecnico').value || '-';
            
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            document.getElementById('termo-data').textContent = dataAtual;
            
            // Gerar protocolo
            const protocolo = `PROT-${new Date().getFullYear()}-${String(entregas.length + 1).padStart(3, '0')}`;
            document.getElementById('termo-protocolo').textContent = protocolo;
            
            // Atualizar equipamentos no termo
            const tbody = document.getElementById('termo-equipamentos');
            if (tbody) {
                tbody.innerHTML = '';
                
                const equipamentos = [
                    { nome: 'CPU', qtd: quantidades.cpu },
                    { nome: 'Monitor', qtd: quantidades.monitor },
                    { nome: 'Cabo de Energia Desktop', qtd: quantidades.caboEnergiaDesktop },
                    { nome: 'Cabo de Energia Monitor', qtd: quantidades.caboEnergiaMonitor },
                    { nome: 'Teclado', qtd: quantidades.teclado },
                    { nome: 'Mouse', qtd: quantidades.mouse },
                    { nome: 'Cabo HDMI', qtd: quantidades.caboHdmi },
                    { nome: 'Cabo VGA', qtd: quantidades.caboVga }
                ];
                
                equipamentos.forEach(equip => {
                    if (equip.qtd > 0) {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${equip.nome}</td>
                            <td class="text-center">${equip.qtd}</td>
                        `;
                        tbody.appendChild(tr);
                    }
                });
                
                // Se não há equipamentos, mostrar mensagem
                if (tbody.children.length === 0) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td colspan="2" class="text-center text-muted">Nenhum equipamento selecionado</td>`;
                    tbody.appendChild(tr);
                }
            }
            
            // Atualizar informações de assinatura
            document.getElementById('termo-usuario-assinatura').textContent = document.getElementById('usuario').value || '-';
            document.getElementById('termo-matricula-assinatura').textContent = document.getElementById('matricula').value || '-';
            document.getElementById('termo-data-assinatura').textContent = dataAtual;
            
            // Verificar se pode habilitar o botão de gerar termo
            const aceite = document.getElementById('aceite-termo').checked;
            const dadosPreenchidos = document.getElementById('usuario').value && 
                                   document.getElementById('matricula').value && 
                                   document.getElementById('setor').value && 
                                   document.getElementById('tecnico').value;
            const temEquipamentos = Object.values(quantidades).some(qtd => qtd > 0);
            
            const btnGerarTermo = document.getElementById('btn-gerar-termo');
            if (btnGerarTermo) {
                btnGerarTermo.disabled = !(aceite && dadosPreenchidos && temEquipamentos);
            }
        }

        // ========== SISTEMA DE IMPRESSÃO ==========
        function visualizarTermo() {
            if (!validarDadosParaTermo()) {
                mostrarStatus('Preencha todos os dados obrigatórios!', 'error');
                return;
            }

            // Atualizar dados na área de impressão
            atualizarDadosImpressao();
            
            // Mostrar modal de pré-visualização
            const modalElement = document.getElementById('modalPreview');
            if (modalElement) {
                const modal = new bootstrap.Modal(modalElement);
                
                // Copiar conteúdo para o modal
                const areaImpressao = document.getElementById('area-impressao');
                if (areaImpressao) {
                    document.getElementById('preview-content').innerHTML = areaImpressao.innerHTML;
                }
                
                modal.show();
            }
        }

        function validarDadosParaTermo() {
            const camposObrigatorios = ['tecnico', 'usuario', 'matricula', 'setor'];
            for (let campo of camposObrigatorios) {
                const element = document.getElementById(campo);
                if (!element || !element.value.trim()) {
                    return false;
                }
            }
            
            // Verificar se há pelo menos um equipamento
            return Object.values(quantidades).some(qtd => qtd > 0);
        }

        function atualizarDadosImpressao() {
            // Atualizar dados básicos
            document.getElementById('impressao-usuario').textContent = document.getElementById('usuario').value || '-';
            document.getElementById('impressao-matricula').textContent = document.getElementById('matricula').value || '-';
            document.getElementById('impressao-setor').textContent = document.getElementById('setor').value || '-';
            document.getElementById('impressao-tecnico').textContent = document.getElementById('tecnico').value || '-';
            
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            document.getElementById('impressao-data').textContent = dataAtual;
            
            // Gerar protocolo
            const protocolo = `PROT-${new Date().getFullYear()}-${String(entregas.length + 1).padStart(3, '0')}`;
            document.getElementById('impressao-protocolo').textContent = `PROTOCOLO: ${protocolo}`;
            
            // Atualizar equipamentos
            const tbody = document.getElementById('impressao-equipamentos');
            if (tbody) {
                tbody.innerHTML = '';
                
                const equipamentos = [
                    { nome: 'CPU', qtd: quantidades.cpu },
                    { nome: 'Monitor', qtd: quantidades.monitor },
                    { nome: 'Cabo de Energia Desktop', qtd: quantidades.caboEnergiaDesktop },
                    { nome: 'Cabo de Energia Monitor', qtd: quantidades.caboEnergiaMonitor },
                    { nome: 'Teclado', qtd: quantidades.teclado },
                    { nome: 'Mouse', qtd: quantidades.mouse },
                    { nome: 'Cabo HDMI', qtd: quantidades.caboHdmi },
                    { nome: 'Cabo VGA', qtd: quantidades.caboVga }
                ];
                
                let totalEquipamentos = 0;
                equipamentos.forEach(equip => {
                    if (equip.qtd > 0) {
                        totalEquipamentos += equip.qtd;
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${equip.nome}</td>
                            <td>${equip.qtd}</td>
                            <td>Conferido e em perfeito estado</td>
                        `;
                        tbody.appendChild(tr);
                    }
                });
                
                document.getElementById('impressao-total').textContent = totalEquipamentos;
                
                // Atualizar assinaturas
                document.getElementById('impressao-usuario-assinatura').textContent = document.getElementById('usuario').value || '-';
                document.getElementById('impressao-matricula-assinatura').textContent = document.getElementById('matricula').value || '-';
                document.getElementById('impressao-assinatura-usuario').textContent = document.getElementById('usuario').value || '-';
                document.getElementById('impressao-assinatura-tecnico').textContent = document.getElementById('tecnico').value || '-';
            }
        }

        function imprimirTermoCompleto() {
            // Primeiro salva a entrega
            const entrega = {
                id: Date.now(),
                protocolo: document.getElementById('impressao-protocolo').textContent.replace('PROTOCOLO: ', ''),
                tecnico: document.getElementById('tecnico').value,
                usuario: document.getElementById('usuario').value,
                matricula: document.getElementById('matricula').value,
                setor: document.getElementById('setor').value,
                data: new Date().toISOString(),
                equipamentos: { ...quantidades },
                totalEquipamentos: Object.values(quantidades).reduce((a, b) => a + b, 0)
            };
            
            entregas.push(entrega);
            localStorage.setItem('celere_entregas', JSON.stringify(entregas));
            
            // Fecha o modal
            const modalElement = document.getElementById('modalPreview');
            if (modalElement) {
                const modal = bootstrap.Modal.getInstance(modalElement);
                if (modal) {
                    modal.hide();
                }
            }
            
            // Aguarda um pouco antes de imprimir
            setTimeout(() => {
                // Atualiza os dados antes de imprimir
                atualizarDadosImpressao();
                
                // Aciona a impressão
                const areaImpressao = document.getElementById('area-impressao');
                if (areaImpressao) {
                    const janelaImpressao = window.open('', '_blank');
                    janelaImpressao.document.write(`
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <title>Termo de Entrega - ${entrega.protocolo}</title>
                            <style>
                                ${obterEstilosImpressao()}
                            </style>
                        </head>
                        <body>
                            ${areaImpressao.innerHTML}
                            <script>
                                window.onload = function() {
                                    window.print();
                                    setTimeout(function() {
                                        window.close();
                                    }, 1000);
                                };
                            <\/script>
                        </body>
                        </html>
                    `);
                    janelaImpressao.document.close();
                }
                
                mostrarStatus('Termo impresso e salvo com sucesso!', 'success');
                atualizarRelatorios();
                limparFormulario();
            }, 500);
        }

        function limparFormulario() {
            // Limpar campos de dados
            document.getElementById('tecnico').value = '';
            document.getElementById('usuario').value = '';
            document.getElementById('matricula').value = '';
            document.getElementById('setor').value = '';
            
            // Limpar quantidades
            document.querySelectorAll('.quantidade-input').forEach(input => {
                input.value = '0';
            });
            
            // Limpar checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Atualizar tudo
            atualizarProgresso();
            atualizarTermo();
            atualizarCheckboxes();
            
            // Voltar para a primeira aba
            proximaAba('dados');
        }

        function obterEstilosImpressao() {
            return `
                body {
                    background: white !important;
                    color: black !important;
                    font-family: 'Arial', sans-serif !important;
                    margin: 0;
                    padding: 0;
                    font-size: 12px;
                }
                
                .timbrado-celere {
                    text-align: center;
                    border-bottom: 3px solid #0f5132;
                    padding: 20px 0;
                    margin-bottom: 25px;
                }
                
                .timbrado-img {
                    max-width: 200px;
                    height: auto;
                    margin-bottom: 15px;
                }
                
                .timbrado-celere .empresa {
                    font-size: 14px;
                    color: #333;
                    margin: 8px 0;
                    font-weight: bold;
                }
                
                .timbrado-celere .cnpj {
                    font-size: 11px;
                    color: #666;
                    margin: 5px 0;
                }
                
                .timbrado-celere .endereco {
                    font-size: 11px;
                    color: #666;
                    margin: 5px 0;
                }
                
                .timbrado-celere .contato {
                    font-size: 11px;
                    color: #666;
                    margin: 5px 0;
                }
                
                .termo-impressao {
                    padding: 15px 30px;
                }
                
                .termo-header {
                    text-align: center;
                    margin-bottom: 25px;
                }
                
                .termo-header h3 {
                    color: #0f5132;
                    font-size: 18px;
                    margin-bottom: 8px;
                    text-transform: uppercase;
                }
                
                .protocolo {
                    background: #f8f9fa;
                    padding: 10px;
                    border: 2px solid #0f5132;
                    margin-bottom: 20px;
                    text-align: center;
                    font-weight: bold;
                    font-size: 14px;
                }
                
                .dados-entrega {
                    margin-bottom: 20px;
                    padding: 15px;
                    border: 1px solid #ddd;
                    background: #fafafa;
                }
                
                .dados-entrega .row {
                    margin-bottom: 8px;
                    display: flex;
                }
                
                .dados-entrega .col-md-6 {
                    width: 50%;
                    padding: 0 10px;
                }
                
                .tabela-equipamentos {
                    width: 100%;
                    border-collapse: collapse;
                    margin: 20px 0;
                    font-size: 11px;
                }
                
                .tabela-equipamentos th {
                    background: #0f5132;
                    color: white;
                    padding: 8px;
                    text-align: left;
                    border: 1px solid #ddd;
                    font-weight: bold;
                }
                
                .tabela-equipamentos td {
                    padding: 8px;
                    border: 1px solid #ddd;
                }
                
                .termo-texto {
                    margin: 20px 0;
                    line-height: 1.4;
                    font-size: 11px;
                    text-align: justify;
                }
                
                .termo-texto strong {
                    color: #0f5132;
                }
                
                .assinaturas {
                    margin-top: 60px;
                    page-break-inside: avoid;
                }
                
                .assinatura-area {
                    width: 45%;
                    display: inline-block;
                    text-align: center;
                    margin: 0 2%;
                    vertical-align: top;
                }
                
                .linha-assinatura {
                    border-top: 1px solid #000;
                    margin-top: 40px;
                    padding-top: 5px;
                    width: 100%;
                }
                
                .nome-assinatura {
                    font-weight: bold;
                    margin-top: 5px;
                    font-size: 11px;
                }
                
                .cargo-assinatura {
                    font-size: 10px;
                    color: #666;
                }
                
                .rodape-termo {
                    margin-top: 30px;
                    text-align: center;
                    font-size: 9px;
                    color: #666;
                    border-top: 1px solid #ddd;
                    padding-top: 10px;
                }
                
                .pagina-inteira {
                    page-break-inside: avoid;
                }
                
                @media print {
                    body {
                        margin: 0;
                        padding: 0;
                    }
                    .no-print {
                        display: none !important;
                    }
                }
            `;
        }

        // ========== RELATÓRIOS ==========
        function atualizarRelatorios() {
            // Estatísticas gerais
            document.getElementById('total-entregas').textContent = entregas.length;
            
            const totalEquipamentos = entregas.reduce((total, entrega) => {
                return total + (entrega.totalEquipamentos || 0);
            }, 0);
            document.getElementById('total-equipamentos').textContent = totalEquipamentos;
            
            const percentualConclusao = Math.min(100, Math.round((totalEquipamentos / 440) * 100));
            document.getElementById('percentual-conclusao').textContent = `${percentualConclusao}%`;
            
            // Técnicos ativos
            const tecnicos = [...new Set(entregas.map(e => e.tecnico))];
            document.getElementById('tecnicos-ativos').textContent = tecnicos.length;
            
            // Distribuição por setor
            const setores = {};
            entregas.forEach(entrega => {
                setores[entrega.setor] = (setores[entrega.setor] || 0) + 1;
            });
            
            const tabelaSetores = document.getElementById('tabela-setores');
            if (tabelaSetores) {
                tabelaSetores.innerHTML = '';
                
                Object.entries(setores).forEach(([setor, count]) => {
                    const percentual = Math.round((count / entregas.length) * 100);
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${setor}</td>
                        <td class="text-center">${count}</td>
                        <td class="text-center">${percentual}%</td>
                    `;
                    tabelaSetores.appendChild(tr);
                });
            }
            
            // Últimas entregas
            const tabelaUltimas = document.getElementById('tabela-ultimas-entregas');
            if (tabelaUltimas) {
                tabelaUltimas.innerHTML = '';
                
                const ultimasEntregas = entregas.slice(-5).reverse();
                ultimasEntregas.forEach(entrega => {
                    const totalEquip = entrega.totalEquipamentos || 0;
                    const data = new Date(entrega.data).toLocaleDateString('pt-BR');
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${data}</td>
                        <td>${entrega.usuario}</td>
                        <td class="text-center">${totalEquip}</td>
                    `;
                    tabelaUltimas.appendChild(tr);
                });
                
                if (ultimasEntregas.length === 0) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td colspan="3" class="text-center text-muted">Nenhuma entrega registrada</td>`;
                    tabelaUltimas.appendChild(tr);
                }
            }
        }

        // ========== EXPORTAÇÃO/IMPORTAÇÃO ==========
        function exportarParaExcel() {
            if (entregas.length === 0) {
                mostrarStatus('Não há dados para exportar!', 'error');
                return;
            }
            
            mostrarStatus('Exportando para Excel...', 'loading');
            // Simular exportação
            setTimeout(() => {
                mostrarStatus('Dados exportados com sucesso!', 'success');
            }, 1500);
        }

        function exportarParaJSON() {
            if (entregas.length === 0) {
                mostrarStatus('Não há dados para exportar!', 'error');
                return;
            }
            
            const dataStr = JSON.stringify(entregas, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `celere-entregas-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            mostrarStatus('Dados exportados para JSON!', 'success');
        }

        function importarDados(file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    if (Array.isArray(dados)) {
                        entregas = dados;
                        localStorage.setItem('celere_entregas', JSON.stringify(entregas));
                        atualizarRelatorios();
                        mostrarStatus('Dados importados com sucesso!', 'success');
                    } else {
                        throw new Error('Formato inválido');
                    }
                } catch (error) {
                    mostrarStatus('Erro ao importar dados!', 'error');
                }
            };
            reader.readAsText(file);
        }

        function limparDados() {
            if (entregas.length === 0) {
                mostrarStatus('Não há dados para limpar!', 'error');
                return;
            }
            
            if (confirm('Tem certeza que deseja limpar todos os dados? Esta ação não pode ser desfeita.')) {
                localStorage.removeItem('celere_entregas');
                entregas = [];
                atualizarRelatorios();
                mostrarStatus('Dados limpos com sucesso!', 'success');
            }
        }

        // ========== FUNÇÃO DE TESTE ==========
        function preencherDadosTeste() {
            document.getElementById('tecnico').value = 'João Silva';
            document.getElementById('usuario').value = 'Maria Santos';
            document.getElementById('matricula').value = '2024001';
            document.getElementById('setor').value = 'TI';
            
            document.getElementById('qtd-cpu').value = '1';
            document.getElementById('qtd-monitor').value = '1';
            document.getElementById('qtd-cabo-energia-desktop').value = '1';
            document.getElementById('qtd-cabo-energia-monitor').value = '1';
            document.getElementById('qtd-teclado').value = '1';
            document.getElementById('qtd-mouse').value = '1';
            
            document.getElementById('aceite-termo').checked = true;
            
            atualizarProgresso();
            atualizarTermo();
            atualizarCheckboxes();
            
            mostrarStatus('Dados de teste preenchidos!', 'success');
        }

        // Adicionar função de teste ao console
        console.log('Digite preencherDadosTeste() no console para testar o sistema');
    </script>
</body>
</html>
