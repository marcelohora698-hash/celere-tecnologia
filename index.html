                            </div>
                        </div>
                    </div>
                    <div class="card-footer d-flex justify-content-between">
                        <button class="btn btn-secondary" onclick="proximaAba('equipamentos')">
                            <i class="fas fa-arrow-left me-2"></i>Voltar
                        </button>
                        <button class="btn btn-custom" onclick="proximaAba('termo')">
                            Pr√≥ximo <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Termo -->
            <div class="tab-pane fade" id="termo">
                <div class="card fade-in">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-file-signature me-2"></i>Termo de Entrega</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Revise os dados antes de gerar o termo de entrega</strong>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="p-3 bg-verde-pagina rounded">
                                    <h6>Dados do Colaborador</h6>
                                    <p class="mb-1"><strong>T√©cnico:</strong> <span id="preview-tecnico">-</span></p>
                                    <p class="mb-1"><strong>Colaborador:</strong> <span id="preview-usuario">-</span></p>
                                    <p class="mb-1"><strong>Matr√≠cula:</strong> <span id="preview-matricula">-</span></p>
                                    <p class="mb-0"><strong>Setor:</strong> <span id="preview-setor">-</span></p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="p-3 bg-verde-pagina rounded">
                                    <h6>Resumo do Kit</h6>
                                    <p class="mb-1"><strong>Total de Equipamentos:</strong> <span id="preview-total">0</span></p>
                                    <p class="mb-1"><strong>Status:</strong> <span id="preview-status">Pendente</span></p>
                                    <p class="mb-0"><strong>Data:</strong> <span id="preview-data">-</span></p>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button class="btn btn-outline-light me-md-2" onclick="visualizarTermo()">
                                <i class="fas fa-eye me-2"></i>Visualizar Termo
                            </button>
                            <button class="btn btn-custom" onclick="gerarTermo()">
                                <i class="fas fa-print me-2"></i>Imprimir Termo
                            </button>
                        </div>
                    </div>
                    <div class="card-footer d-flex justify-content-between">
                        <button class="btn btn-secondary" onclick="proximaAba('quantidades')">
                            <i class="fas fa-arrow-left me-2"></i>Voltar
                        </button>
                        <button class="btn btn-success" onclick="salvarEntrega()">
                            <i class="fas fa-save me-2"></i>Salvar Entrega
                        </button>
                    </div>
                </div>
            </div>

            <!-- Relat√≥rios -->
            <div class="tab-pane fade" id="relatorios">
                <div class="card fade-in">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Relat√≥rios e Dados</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="stats-card text-center">
                                    <h3 id="total-entregas">0</h3>
                                    <p class="mb-0">Total de Entregas</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-card text-center">
                                    <h3 id="total-equipamentos">0</h3>
                                    <p class="mb-0">Equipamentos Entregues</p>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stats-card text-center">
                                    <h3 id="progresso-geral">0%</h3>
                                    <p class="mb-0">Progresso Geral</p>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <h6>√öltimas Entregas</h6>
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Data</th>
                                            <th>Colaborador</th>
                                            <th>Setor</th>
                                            <th>Equipamentos</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tabela-entregas">
                                        <tr>
                                            <td colspan="4" class="text-center">Nenhuma entrega registrada</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-light" onclick="exportarDados()">
                                <i class="fas fa-download me-2"></i>Exportar Dados
                            </button>
                            <button class="btn btn-outline-light" onclick="limparDados()">
                                <i class="fas fa-trash me-2"></i>Limpar Dados
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Visualiza√ß√£o do Termo -->
    <div class="modal fade modal-preview" id="modalTermo" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Pr√©-visualiza√ß√£o do Termo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="conteudo-termo">
                        <!-- Conte√∫do do termo ser√° inserido aqui via JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-custom" onclick="imprimirTermo()">Imprimir</button>
                </div>
            </div>
        </div>
    </div>

    <!-- √Årea de Importa√ß√£o (oculta) -->
    <input type="file" id="importFile" accept=".json" style="display: none;">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Vari√°veis globais
        let entregas = JSON.parse(localStorage.getItem('celere_entregas')) || [];
        const totalEquipamentosMeta = 440;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            atualizarProgresso();
            atualizarRelatorios();
            atualizarDataPreview();
            
            // Atualizar badges em tempo real
            document.querySelectorAll('.quantidade-input').forEach(input => {
                input.addEventListener('input', atualizarBadges);
            });
            
            atualizarBadges();
        });

        // Navega√ß√£o entre abas
        function proximaAba(aba) {
            const tab = new bootstrap.Tab(document.querySelector(`a[href="#${aba}"]`));
            tab.show();
        }

        // Atualizar badges de quantidade
        function atualizarBadges() {
            const equipamentos = [
                'cpu', 'monitor', 'cabo-energia-desktop', 'cabo-energia-monitor',
                'teclado', 'mouse', 'cabo-hdmi', 'cabo-vga'
            ];
            
            equipamentos.forEach(equip => {
                const qtd = parseInt(document.getElementById(`qtd-${equip}`).value) || 0;
                const badge = document.getElementById(`badge-${equip}`);
                if (badge) {
                    badge.textContent = qtd;
                    // Atualizar tamb√©m os resumos
                    const resumo = document.getElementById(`resumo-${equip}`);
                    if (resumo) resumo.textContent = qtd;
                }
            });
            
            atualizarPreview();
        }

        // Atualizar preview do termo
        function atualizarPreview() {
            document.getElementById('preview-tecnico').textContent = document.getElementById('tecnico').value || '-';
            document.getElementById('preview-usuario').textContent = document.getElementById('usuario').value || '-';
            document.getElementById('preview-matricula').textContent = document.getElementById('matricula').value || '-';
            document.getElementById('preview-setor').textContent = document.getElementById('setor').value || '-';
            
            const total = calcularTotalEquipamentos();
            document.getElementById('preview-total').textContent = total;
            document.getElementById('preview-status').textContent = total > 0 ? 'Completo' : 'Pendente';
        }

        // Atualizar data no preview
        function atualizarDataPreview() {
            const data = new Date().toLocaleDateString('pt-BR');
            document.getElementById('preview-data').textContent = data;
        }

        // Calcular total de equipamentos
        function calcularTotalEquipamentos() {
            let total = 0;
            document.querySelectorAll('.quantidade-input').forEach(input => {
                total += parseInt(input.value) || 0;
            });
            return total;
        }

        // Atualizar progresso geral
        function atualizarProgresso() {
            const totalEntregues = entregas.reduce((acc, entrega) => acc + entrega.totalEquipamentos, 0);
            const progresso = (totalEntregues / totalEquipamentosMeta) * 100;
            
            document.getElementById('progresso-texto').textContent = 
                `Progresso: ${totalEntregues}/${totalEquipamentosMeta} equipamentos (${Math.round(progresso)}%)`;
            document.getElementById('progresso-bar').style.width = `${Math.min(progresso, 100)}%`;
            
            atualizarBadges();
        }

        // Atualizar relat√≥rios
        function atualizarRelatorios() {
            document.getElementById('total-entregas').textContent = entregas.length;
            
            const totalEquip = entregas.reduce((acc, entrega) => acc + entrega.totalEquipamentos, 0);
            document.getElementById('total-equipamentos').textContent = totalEquip;
            
            const progressoGeral = Math.round((totalEquip / totalEquipamentosMeta) * 100);
            document.getElementById('progresso-geral').textContent = `${progressoGeral}%`;
            
            // Atualizar tabela de entregas
            const tbody = document.getElementById('tabela-entregas');
            if (entregas.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center">Nenhuma entrega registrada</td></tr>';
            } else {
                tbody.innerHTML = entregas.slice(-5).reverse().map(entrega => `
                    <tr>
                        <td>${entrega.data}</td>
                        <td>${entrega.usuario}</td>
                        <td>${entrega.setor}</td>
                        <td>${entrega.totalEquipamentos}</td>
                    </tr>
                `).join('');
            }
        }

        // Visualizar termo
        function visualizarTermo() {
            if (!validarDados()) {
                alert('Por favor, preencha todos os campos obrigat√≥rios antes de gerar o termo.');
                return;
            }
            
            const modal = new bootstrap.Modal(document.getElementById('modalTermo'));
            document.getElementById('conteudo-termo').innerHTML = gerarConteudoTermo();
            modal.show();
        }

        // Gerar conte√∫do do termo para impress√£o
        function gerarConteudoTermo() {
            const tecnico = document.getElementById('tecnico').value;
            const usuario = document.getElementById('usuario').value;
            const matricula = document.getElementById('matricula').value;
            const setor = document.getElementById('setor').value;
            const data = new Date().toLocaleDateString('pt-BR');
            const protocolo = 'CEL-' + Date.now();
            
            return `
                <div class="termo-impressao">
                    <div class="timbrado-celere">
                        <div class="empresa">C√âLERE TECNOLOGIA EM SA√öDE LTDA</div>
                        <div class="cnpj">CNPJ: 12.345.678/0001-90</div>
                        <div class="endereco">Rua Exemplo, 123 - Centro - S√£o Paulo/SP</div>
                        <div class="contato">Tel: (11) 9999-9999 | www.celeretecnologia.com.br</div>
                    </div>
                    
                    <div class="termo-header">
                        <h3>TERMO DE ENTREGA DE EQUIPAMENTOS DE INFORM√ÅTICA</h3>
                        <div class="protocolo">Protocolo: ${protocolo}</div>
                    </div>
                    
                    <div class="dados-entrega">
                        <div class="row">
                            <div class="col-md-6">
                                <strong>T√©cnico Respons√°vel:</strong> ${tecnico}
                            </div>
                            <div class="col-md-6">
                                <strong>Data da Entrega:</strong> ${data}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Colaborador:</strong> ${usuario}
                            </div>
                            <div class="col-md-6">
                                <strong>Matr√≠cula:</strong> ${matricula}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <strong>Setor:</strong> ${setor}
                            </div>
                        </div>
                    </div>
                    
                    <table class="tabela-equipamentos">
                        <thead>
                            <tr>
                                <th>Equipamento</th>
                                <th>Quantidade</th>
                                <th>Descri√ß√£o</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${gerarLinhasTabelaEquipamentos()}
                        </tbody>
                    </table>
                    
                    <div class="termo-texto">
                        <p>Declaro para os devidos fins que recebi os equipamentos relacionados acima, 
                        em perfeito estado de funcionamento e me comprometo a zelar pela conserva√ß√£o 
                        dos mesmos, responsabilizando-me por quaisquer danos causados por uso inadequado 
                        ou neglig√™ncia.</p>
                        
                        <p><strong>Observa√ß√µes:</strong> Os equipamentos s√£o de uso exclusivo para 
                        atividades profissionais e devem ser devolvidos ao departamento de TI 
                        em caso de desligamento ou mudan√ßa de fun√ß√£o.</p>
                    </div>
                    
                    <div class="assinaturas pagina-inteira">
                        <div class="assinatura-area">
                            <div class="linha-assinatura"></div>
                            <div class="nome-assinatura">${tecnico}</div>
                            <div class="cargo-assinatura">T√©cnico de TI - C√©lere Tecnologia</div>
                        </div>
                        
                        <div class="assinatura-area">
                            <div class="linha-assinatura"></div>
                            <div class="nome-assinatura">${usuario}</div>
                            <div class="cargo-assinatura">Colaborador - Matr√≠cula: ${matricula}</div>
                        </div>
                    </div>
                    
                    <div class="rodape-termo">
                        Documento gerado automaticamente pelo Sistema C√©lere - ${new Date().toLocaleString('pt-BR')}
                    </div>
                </div>
            `;
        }

        // Gerar linhas da tabela de equipamentos
        function gerarLinhasTabelaEquipamentos() {
            const equipamentos = [
                { id: 'cpu', nome: 'CPU/Computador', emoji: 'üíª' },
                { id: 'monitor', nome: 'Monitor', emoji: 'üñ•Ô∏è' },
                { id: 'cabo-energia-desktop', nome: 'Cabo de Energia Desktop', emoji: 'üîå' },
                { id: 'cabo-energia-monitor', nome: 'Cabo de Energia Monitor', emoji: 'üîå' },
                { id: 'teclado', nome: 'Teclado', emoji: '‚å®Ô∏è' },
                { id: 'mouse', nome: 'Mouse', emoji: 'üñ±Ô∏è' },
                { id: 'cabo-hdmi', nome: 'Cabo HDMI', emoji: 'üì∫' },
                { id: 'cabo-vga', nome: 'Cabo VGA', emoji: 'üì∫' }
            ];
            
            return equipamentos.map(equip => {
                const qtd = parseInt(document.getElementById(`qtd-${equip.id}`).value) || 0;
                if (qtd > 0) {
                    return `
                        <tr>
                            <td>${equip.emoji} ${equip.nome}</td>
                            <td>${qtd}</td>
                            <td>Equipamento de inform√°tica</td>
                        </tr>
                    `;
                }
                return '';
            }).join('');
        }

        // Validar dados antes de salvar
        function validarDados() {
            const camposObrigatorios = ['tecnico', 'usuario', 'matricula', 'setor'];
            for (let campo of camposObrigatorios) {
                if (!document.getElementById(campo).value.trim()) {
                    return false;
                }
            }
            
            // Verificar se h√° pelo menos um equipamento
            if (calcularTotalEquipamentos() === 0) {
                return false;
            }
            
            return true;
        }

        // Salvar entrega
        function salvarEntrega() {
            if (!validarDados()) {
                alert('Por favor, preencha todos os campos obrigat√≥rios e adicione pelo menos um equipamento.');
                return;
            }
            
            const entrega = {
                id: Date.now(),
                data: new Date().toLocaleString('pt-BR'),
                tecnico: document.getElementById('tecnico').value,
                usuario: document.getElementById('usuario').value,
                matricula: document.getElementById('matricula').value,
                setor: document.getElementById('setor').value,
                equipamentos: obterEquipamentosQuantidades(),
                totalEquipamentos: calcularTotalEquipamentos()
            };
            
            entregas.push(entrega);
            localStorage.setItem('celere_entregas', JSON.stringify(entregas));
            
            mostrarStatus('Entrega salva com sucesso!', 'success');
            atualizarProgresso();
            atualizarRelatorios();
            limparFormulario();
            
            // Voltar para a primeira aba
            proximaAba('dados');
        }

        // Obter quantidades dos equipamentos
        function obterEquipamentosQuantidades() {
            const equipamentos = {};
            document.querySelectorAll('.quantidade-input').forEach(input => {
                equipamentos[input.id.replace('qtd-', '')] = parseInt(input.value) || 0;
            });
            return equipamentos;
        }

        // Limpar formul√°rio
        function limparFormulario() {
            document.getElementById('tecnico').value = '';
            document.getElementById('usuario').value = '';
            document.getElementById('matricula').value = '';
            document.getElementById('setor').value = '';
            
            document.querySelectorAll('.quantidade-input').forEach(input => {
                input.value = '0';
            });
            
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            atualizarBadges();
            atualizarPreview();
        }

        // Mostrar status
        function mostrarStatus(mensagem, tipo) {
            const status = document.getElementById('syncStatus');
            status.textContent = mensagem;
            status.className = `sync-status sync-${tipo}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // Exportar dados
        function exportarDados() {
            if (entregas.length === 0) {
                alert('N√£o h√° dados para exportar.');
                return;
            }
            
            const dataStr = JSON.stringify(entregas, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `celere-entregas-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Limpar dados
        function limparDados() {
            if (confirm('Tem certeza que deseja limpar todos os dados? Esta a√ß√£o n√£o pode ser desfeita.')) {
                localStorage.removeItem('celere_entregas');
                entregas = [];
                atualizarProgresso();
                atualizarRelatorios();
                mostrarStatus('Dados limpos com sucesso!', 'success');
            }
        }

        // Imprimir termo
        function imprimirTermo() {
            window.print();
        }

        // Gerar termo (para o bot√£o Imprimir Termo)
        function gerarTermo() {
            if (!validarDados()) {
                alert('Por favor, preencha todos os campos obrigat√≥rios antes de gerar o termo.');
                return;
            }
            
            const conteudo = gerarConteudoTermo();
            const janela = window.open('', '_blank');
            janela.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Termo de Entrega - C√©lere</title>
                    <style>
                        ${document.querySelector('style').textContent}
                    </style>
                </head>
                <body>${conteudo}</body>
                </html>
            `);
            janela.document.close();
            janela.print();
        }
    </script>
</body>
</html>
